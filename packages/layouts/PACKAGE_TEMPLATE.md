# Package Template

Use this template when creating new packages in the monorepo.

## Directory Structure

```
packages/new-package/
├── src/
│   ├── components/
│   ├── utils/
│   └── index.ts
├── dist/                    # Generated by build
├── package.json
├── tsconfig.json
├── tsup.config.ts
├── .releaserc.json
├── README.md
└── CHANGELOG.md            # Auto-generated
```

## package.json Template

```json
{
  "name": "@your-org/package-name",
  "version": "0.1.0",
  "description": "Brief description of your package",
  "type": "module",
  "main": "./dist/index.cjs",
  "module": "./dist/index.mjs",
  "types": "./dist/index.d.ts",
  "exports": {
    ".": {
      "types": "./dist/index.d.ts",
      "import": "./dist/index.mjs",
      "require": "./dist/index.cjs"
    }
  },
  "files": [
    "dist",
    "README.md",
    "CHANGELOG.md"
  ],
  "scripts": {
    "build": "tsup",
    "lint": "npx ultracite lint",
    "format": "npx ultracite fix",
    "typecheck": "tsc --noEmit",
    "semantic-release": "semantic-release"
  },
  "peerDependencies": {
    "react": "^18.0.0 || ^19.0.0",
    "react-dom": "^18.0.0 || ^19.0.0"
  },
  "dependencies": {
    // Add runtime dependencies here
  },
  "devDependencies": {
    "@semantic-release/changelog": "catalog:",
    "@semantic-release/git": "catalog:",
    "@semantic-release/github": "catalog:",
    "@semantic-release/npm": "catalog:",
    "@types/node": "catalog:",
    "@types/react": "catalog:",
    "@types/react-dom": "catalog:",
    "@your-org/typescript-config": "workspace:*",
    "semantic-release": "catalog:",
    "tsup": "catalog:",
    "typescript": "catalog:"
  },
  "keywords": [
    "react",
    "component",
    "your-keywords"
  ],
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/your-org/your-ui-components-repo.git",
    "directory": "packages/package-name"
  }
}
```

## tsconfig.json Template

```json
{
  "extends": "@your-org/typescript-config/react-library.json",
  "compilerOptions": {
    "baseUrl": ".",
    "outDir": "./dist"
  },
  "include": ["src"],
  "exclude": ["node_modules", "dist"]
}
```

## tsup.config.ts Template

```typescript
import { defineConfig } from "tsup";

export default defineConfig({
  entry: ["src/index.ts"],
  format: ["cjs", "esm"],
  dts: true,
  splitting: false,
  sourcemap: true,
  clean: true,
  external: ["react", "react-dom"],
  outExtension({ format }) {
    return {
      js: format === "cjs" ? ".cjs" : ".mjs",
    };
  },
});
```

## .releaserc.json Template

Replace `package-name` with your actual package name:

```json
{
  "branches": [
    "main",
    {
      "name": "beta",
      "prerelease": true
    }
  ],
  "plugins": [
    [
      "@semantic-release/commit-analyzer",
      {
        "preset": "conventionalcommits",
        "releaseRules": [
          {
            "type": "feat",
            "scope": "package-name",
            "release": "minor"
          },
          {
            "type": "fix",
            "scope": "package-name",
            "release": "patch"
          },
          {
            "type": "feat",
            "scope": "package-name",
            "breaking": true,
            "release": "major"
          }
        ]
      }
    ],
    "@semantic-release/release-notes-generator",
    [
      "@semantic-release/changelog",
      {
        "changelogFile": "CHANGELOG.md"
      }
    ],
    [
      "@semantic-release/npm",
      {
        "npmPublish": true,
        "pkgRoot": "."
      }
    ],
    [
      "@semantic-release/git",
      {
        "assets": [
          "package.json",
          "CHANGELOG.md"
        ],
        "message": "chore(release): ${nextRelease.version} [skip ci]\n\n${nextRelease.notes}"
      }
    ],
    "@semantic-release/github"
  ]
}
```

## src/index.ts Template

```typescript
// Export components
export { default as MyComponent } from "./components/MyComponent.js";

// Export types
export type { MyComponentProps } from "./components/MyComponent.js";

// Export utilities (if any)
export { utilityFunction } from "./utils/helpers.js";
```

## src/utils/cn.ts Template

If you need Tailwind class merging:

```typescript
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

## Component Template

```typescript
import React from "react";
import { cn } from "../utils/cn.js";

export interface MyComponentProps {
  children: React.ReactNode;
  className?: string;
}

const MyComponent: React.FC<MyComponentProps> = React.memo(({ 
  children, 
  className 
}) => {
  return (
    <div className={cn("base-styles", className)}>
      {children}
    </div>
  );
});

MyComponent.displayName = "MyComponent";

export default MyComponent;
```

## Quick Setup Steps

1. Create directory: `mkdir -p packages/new-package/src`
2. Copy templates above into respective files
3. Replace placeholders:
   - `@your-org/package-name` → actual package name
   - `package-name` → actual package name (in .releaserc.json scope)
   - `your-org` → your npm organization
4. Update `pnpm-workspace.yaml` if needed (should auto-detect)
5. Add release step to `.github/workflows/release.yml`
6. Run `pnpm install`
7. Create your components in `src/`
8. Build: `pnpm --filter new-package build`

## Adding to Release Workflow

Add this to `.github/workflows/release.yml`:

```yaml
- name: Release new-package
  working-directory: ./packages/new-package
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
  run: pnpm run semantic-release
  continue-on-error: true
```

## Important Notes

- Always use `.js` extensions in TypeScript imports (required for NodeNext module resolution)
- Use `React.memo` for component optimization
- Set `displayName` for better debugging
- Keep components focused and single-purpose
- Export types alongside components
- Use the `cn` utility for conditional Tailwind classes

